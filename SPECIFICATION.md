# ã‚¹ã‚­ãƒ¼ãƒ ãƒ¡ãƒ¼ã‚«ãƒ¼é–‹ç™ºãƒ­ã‚°ï¼†ä»•æ§˜æ›¸

## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦
**åç§°:** Blueprint Engine 24 (ã‚¹ã‚­ãƒ¼ãƒ ãƒ¡ãƒ¼ã‚«ãƒ¼)
**ç›®çš„:** ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å…¥åŠ›ãƒ†ã‚­ã‚¹ãƒˆã‚„ç”»åƒã‹ã‚‰ã€æ§‹é€ åŒ–ã•ã‚ŒãŸã‚¤ãƒ³ãƒ•ã‚©ã‚°ãƒ©ãƒ•ã‚£ãƒƒã‚¯ï¼ˆå›³è§£ï¼‰ã‚’è‡ªå‹•ç”Ÿæˆã™ã‚‹ã€‚
**ã‚³ã‚¢æ©Ÿèƒ½:**
1.  **æ§‹é€ è§£æ (Step 1-2):** ãƒ†ã‚­ã‚¹ãƒˆã‚’JSONæ§‹é€ ãƒ‡ãƒ¼ã‚¿ã«å¤‰æ›ã€‚
2.  **ãƒ‰ãƒ©ãƒ•ãƒˆç”Ÿæˆ (Step 3):** ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆç¢ºèªç”¨ã®ç™½é»’ãƒ©ãƒ•ç”»ã‚’å¼·åˆ¶å‡ºåŠ›ã€‚
3.  **ãƒ‡ã‚¶ã‚¤ãƒ³æ¸…æ›¸ (Step 4):** 10ç¨®é¡ä»¥ä¸Šã®ã‚¹ã‚¿ã‚¤ãƒ«ã§é«˜å“è³ªãªæœ€çµ‚ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã€‚é¸æŠå¯èƒ½ãªã‚¹ã‚¿ã‚¤ãƒ«å¤‰æ›´æ©Ÿèƒ½ã€‚
4.  **ãƒ¢ãƒã‚¤ãƒ«æœ€é©åŒ–:** é€šä¿¡é‡ãƒ»APIåˆ¶é™ï¼ˆQuotaï¼‰ã‚’è€ƒæ…®ã—ãŸç”»åƒå‡¦ç†ã¨ãƒªãƒˆãƒ©ã‚¤æ©Ÿèƒ½ã€‚

## ä¸»è¦æ©Ÿèƒ½ä»•æ§˜ (v2.1 Update)

### 1. UI/UXãƒ‡ã‚¶ã‚¤ãƒ³
*   **ãƒ˜ãƒƒãƒ€ãƒ¼:**
    *   **ãƒ­ã‚´:** å·¦å´ã«é…ç½® (`logo.png`, w:200, h:50)ã€‚
    *   **ã‚¿ã‚¤ãƒˆãƒ«:** ä¸­å¤®é…ç½®ã€‚ã€Œãƒ–ãƒ«ãƒ¼ãƒ—ãƒªãƒ³ãƒˆã‚¨ãƒ³ã‚¸ãƒ³24ã€ï¼ˆã‚«ã‚¿ã‚«ãƒŠè¡¨è¨˜ï¼‰ã€‚
    *   **ã‚¨ãƒ•ã‚§ã‚¯ãƒˆ:** ã‚¿ã‚¤ãƒˆãƒ«æ–‡å­—ã« `animate-text-shimmer` ã«ã‚ˆã‚‹å¸¸æ™‚ã‚·ãƒãƒ¼ï¼ˆå…‰æ²¢ï¼‰ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’é©ç”¨ã€‚
    *   **ã‚¢ã‚¤ã‚³ãƒ³:** å±¥æ­´ãƒ»è¨­å®šã‚¢ã‚¤ã‚³ãƒ³ã®è¦–èªæ€§ã‚’å‘ä¸Šï¼ˆã‚µã‚¤ã‚ºæ‹¡å¤§ã€è‰²èª¿æ•´ï¼‰ã€‚
    *   **ãƒ•ã‚¡ãƒ“ã‚³ãƒ³:** å°‚ç”¨ã‚¢ã‚¤ã‚³ãƒ³ (`src/app/icon.png`) ã‚’è¨­å®šæ¸ˆã¿ã€‚
*   **Step 2 (æ§‹æˆæ¡ˆç¢ºèª):**
    *   AIç”Ÿæˆã•ã‚ŒãŸæ§‹é€ ï¼ˆã‚¿ã‚¤ãƒˆãƒ«ã€æ¦‚è¦ã€å„ã‚¹ãƒ†ãƒƒãƒ—ã®ãƒ©ãƒ™ãƒ«ãƒ»è¦–è¦šæŒ‡ç¤ºï¼‰ã¯å…¨ã¦ç·¨é›†å¯èƒ½ã€‚
    *   æ˜ç¢ºãªå…¥åŠ›ãƒœãƒƒã‚¯ã‚¹å½¢å¼ã®UIã‚’æ¡ç”¨ã—ã€ç·¨é›†å¯èƒ½ã§ã‚ã‚‹ã“ã¨ã‚’è¦–è¦šçš„ã«å¼·èª¿ã€‚
    *   ç·¨é›†å†…å®¹ã¯ `draftData` ã‚¹ãƒ†ãƒ¼ãƒˆã«å³æ™‚åæ˜ ã•ã‚Œã€å¾Œç¶šã®ç”»åƒç”Ÿæˆãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã«ä½¿ç”¨ã•ã‚Œã‚‹ã€‚

### 2. å¤šè¨€èªå¯¾å¿œ (Multi-language Support)
*   **æ©Ÿèƒ½:** å…¥åŠ›è¨€èªã¨å‡ºåŠ›è¨€èªã‚’æŸ”è»Ÿã«çµ„ã¿åˆã‚ã›å¯èƒ½ï¼ˆä¾‹ï¼šæ—¥æœ¬èªå…¥åŠ› â†’ è‹±èªå›³è§£ï¼‰ã€‚
*   **UI:** Step 1 è¨­å®šã‚¨ãƒªã‚¢ã«ã€Œå‡ºåŠ›è¨€èª (Output Language)ã€é¸æŠè‚¢ã‚’è¿½åŠ ï¼ˆæ—¥ãƒ»è‹±ãƒ»ä¸­ãƒ»éŸ“ãƒ»ä»ãƒ»è¥¿ï¼‰ã€‚
*   **ãƒ­ã‚¸ãƒƒã‚¯:**
    *   **Structure Prompt:** JSONç”Ÿæˆæ™‚ã«ã€`label` ç­‰ã®ãƒ†ã‚­ã‚¹ãƒˆã‚’æŒ‡å®šè¨€èªã¸ç¿»è¨³ãƒ»çµ±ä¸€ã™ã‚‹ã‚ˆã†æŒ‡ç¤ºã€‚
    *   **Image Prompt:** ç”»åƒç”Ÿæˆãƒ—ãƒ­ãƒ³ãƒ—ãƒˆå†…ã®ã€Œè¨€èªæŒ‡å®šã€ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’å‹•çš„ã«æ›¸ãæ›ãˆ (`All text labels... MUST be in ${targetLanguage}`)ã€‚
*   **ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ:** "Japanese"

### 3. ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚° (High-Fidelity)
*   **God Prompt:** ãƒªãƒãƒ¼ã‚¹ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚°ã«åŸºã¥ã„ãŸè©³ç´°ãªå½¹å‰²å®šç¾©ãƒ»ç›®çš„ãƒ»æ§‹é€ å®šç¾©ãƒ»ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãƒãƒƒãƒ”ãƒ³ã‚°ã‚’ä½¿ç”¨ã€‚
*   **Draft Mode:** ã‚¹ã‚¿ã‚¤ãƒ«æŒ‡å®šã‚’ç„¡è¦–ã—ã€ç™½é»’ã®ãƒ©ãƒ•ã‚¹ã‚±ãƒƒãƒã‚’å¼·åˆ¶ã™ã‚‹ã‚ªãƒ¼ãƒãƒ¼ãƒ©ã‚¤ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯ã‚’å®Ÿè£…ã€‚
*   **Final Mode:** ãƒ‰ãƒ©ãƒ•ãƒˆã®æ§‹å›³ã‚’ç¶­æŒã—ã¤ã¤ã€æŒ‡å®šã‚¹ã‚¿ã‚¤ãƒ«ï¼ˆãƒ“ã‚¸ãƒã‚¹ãƒ»ãƒ—ãƒ­ã€ãƒãƒƒãƒ—ãƒ»ã‚¤ãƒ³ãƒ•ã‚©ç­‰ï¼‰ã‚’å³å¯†ã«é©ç”¨ã™ã‚‹ã‚ªãƒ¼ãƒãƒ¼ãƒ©ã‚¤ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯ã‚’å®Ÿè£…ã€‚

### 3.5. Advanced Prompt Editing (Safety Locks)
*   **Step 2 (Draft Prompt) & Step 3 (Final Prompt):**
    *   ä¸Šç´šè€…å‘ã‘ã®ã‚¢ã‚³ãƒ¼ãƒ‡ã‚£ã‚ªãƒ³ãƒ¡ãƒ‹ãƒ¥ãƒ¼å†…ã«ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆç·¨é›†ã‚¨ãƒªã‚¢ã‚’é…ç½®ã€‚
    *   **å®‰å…¨æªç½® (Safety Lock):** ã€Œæ‰‹å‹•ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’é©ç”¨ã™ã‚‹ (Override with manual prompt)ã€ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã‚’å°å…¥ã€‚
    *   **ãƒ­ã‚¸ãƒƒã‚¯:** ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ãŒ **ON** ã®å ´åˆã®ã¿ã€ãƒ•ã‚©ãƒ¼ãƒ ã®è¨­å®šï¼ˆã‚¿ã‚¤ãƒˆãƒ«å¤‰æ›´ãªã©ï¼‰ã‚’ç„¡è¦–ã—ã€ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢ã®æ‰‹å‹•ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ãã®ã¾ã¾AIã«é€ä¿¡ã™ã‚‹ã€‚OFFã®å ´åˆã¯è‡ªå‹•ç”Ÿæˆãƒ­ã‚¸ãƒƒã‚¯ãŒå„ªå…ˆã•ã‚Œã‚‹ã€‚
    *   **UI:** ãƒã‚§ãƒƒã‚¯OFFæ™‚ã¯ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢ã‚’ç„¡åŠ¹åŒ–ï¼ˆã‚°ãƒ¬ãƒ¼ã‚¢ã‚¦ãƒˆï¼‰ã—ã€èª¤æ“ä½œã‚’é˜²æ­¢ã€‚

### 3.6. History System
*   **Functionality:**
    *   Automatically saves generated final images and their metadata (prompts, title, settings) to `localStorage`.
    *   "History" button in the header opens a modal to view past creations.
    *   Users can load a previous state or delete items.
*   **Data Stored:** Timestamp, Final Image (Base64), Title, Prompts, Config.

### 3.7. System & Deployment
*   **API Key Handling:**
    *   **Step 1:** APIã‚­ãƒ¼å…¥åŠ›æ¬„ãŒç©ºã®å ´åˆã€ãƒ†ã‚­ã‚¹ãƒˆå…¥åŠ›æ–‡å­—æ•°ï¼ˆ5æ–‡å­—ä»¥ä¸Šï¼‰ã®ã¿ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦å‡¦ç†ã‚’é–‹å§‹ã™ã‚‹ï¼ˆã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ã®ç’°å¢ƒå¤‰æ•° `GEMINI_API_KEY` ã‚’åˆ©ç”¨ï¼‰ã€‚
    *   **Step 3/4:** ç”Ÿæˆãƒœã‚¿ãƒ³æŠ¼ä¸‹æ™‚ã®ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚µã‚¤ãƒ‰APIã‚­ãƒ¼å¿…é ˆãƒã‚§ãƒƒã‚¯ã‚’å‰Šé™¤ã€‚ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ã§ã‚­ãƒ¼ãŒå­˜åœ¨ã™ã‚Œã°å®Ÿè¡Œå¯èƒ½ã¨ã™ã‚‹ï¼ˆVercelå¯¾å¿œï¼‰ã€‚

*   **AIä¿®æ­£æŒ‡ç¤º (AI Update):** ãƒ˜ãƒƒãƒ€ãƒ¼ã‚¨ãƒªã‚¢ã‹ã‚‰å‰Šé™¤ã—ã€æ§‹æˆè¦ç´ ç·¨é›†ã‚¨ãƒªã‚¢ã®ä¸‹éƒ¨ï¼ˆã€Œä¸Šç´šè€…å‘ã‘ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆç·¨é›†ã€ã®ç›´ä¸Šï¼‰ã«ç§»å‹•é…ç½®ã€‚ç·¨é›†ãƒ•ãƒ­ãƒ¼ã®è‡ªç„¶ãªæµã‚Œã«æœ€é©åŒ–ã€‚

### 3.9. Mobile API Optimization (Critical)
*   **Image Compression:** 
    *   Upload images are automatically resized to **512px (max-side)**.
    *   Compression quality set to **0.5 (JPEG)** to minimize Token (TPM) consumption.
*   **Final Step (Step 4) Efficiency:** 
    *   Draft images are **NOT** sent as visual references during final rendering to save bandwidth and quota.
    *   Detailed text prompts are used exclusively to ensure structural adherence.
*   **Server-Side Fallback & Retry:**
    *   **Fallback Chain:** `nano-banana-pro-preview` -> `gemini-2.0-flash-exp` -> `gemini-1.5-pro` -> `gemini-1.5-flash`.
    *   **Retry Delay:** Automatic 2-second interval before retrying after a "Quota Exceeded (429)" error.

### 3.10. Settings & API Management
*   **Persistence:** Personal API keys are saved in `localStorage`.
*   **Status Indicator:** Settings modal displays:
    *   Current key status (Shared vs Personal).
    *   **Last 4 digits** of the applied personal key for user verification.
*   **Clearance:** Warning displayed when using the shared (limited) fallback key.

### 4. Expansion of Contents
*   **New Archetypes:** `ãƒãƒˆãƒªãƒƒã‚¯ã‚¹ (4è±¡é™ / 2x2åˆ†æ)`.
*   **New Styles:** `é»’æ¿ã‚¢ãƒ¼ãƒˆ (Blackboard Art)`.
*   **Style Previews:** Grid-based selection UI with visual gradients for intuitive choices.
*   **Character Role:** Selection between "General Use" and "Narrator Role" for reference images.
*   **Input Tips:** "ğŸ’¡ å…¥åŠ›ã®ã‚³ãƒ„" section added to guide high-quality text input.

## ç›´è¿‘ã®å¤‰æ›´å±¥æ­´ (2025-12-19)

### Phase 1: æ©Ÿèƒ½æ‹¡å¼µã¨UI/UXæ”¹å–„
1.  **æ–°æ©Ÿèƒ½è¿½åŠ :**
    *   ã€Œãƒãƒˆãƒªãƒƒã‚¯ã‚¹ (4è±¡é™ / 2x2åˆ†æ)ã€æ§‹é€ ã®è¿½åŠ 
    *   æ–°ã‚¹ã‚¿ã‚¤ãƒ«ã€Œé»’æ¿ã‚¢ãƒ¼ãƒˆ (Blackboard Art)ã€ã®è¿½åŠ 
    *   å‚è€ƒç”»åƒã®å½¹å‰²é¸æŠæ©Ÿèƒ½ï¼ˆãƒ¡ã‚¤ãƒ³åˆ©ç”¨ / è§£èª¬è€…ã¨ã—ã¦é…ç½®ï¼‰
    *   å…¥åŠ›ãƒ’ãƒ³ãƒˆã€ŒğŸ’¡ å…¥åŠ›ã®ã‚³ãƒ„ã€ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®è¿½åŠ 
2.  **UI/UXå‘ä¸Š:**
    *   ã‚¹ã‚¿ã‚¤ãƒ«é¸æŠã‚’ã‚°ãƒªãƒƒãƒ‰å½¢å¼ã«å¤‰æ›´ï¼ˆè¦–è¦šçš„ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ä»˜ãï¼‰
    *   ã€Œã‚¹ã‚¿ã‚¤ãƒ«å¤‰æ›´ã€ãƒœã‚¿ãƒ³ã®è¿½åŠ ï¼ˆæ§‹é€ ã‚’ä¿æŒã—ãŸã¾ã¾ã‚¹ã‚¿ã‚¤ãƒ«ã®ã¿å¤‰æ›´å¯èƒ½ï¼‰
    *   ã€Œæ§‹æˆã®ç¢ºèªã«æˆ»ã‚‹ã€ãƒœã‚¿ãƒ³ã®è¿½åŠ 
    *   ãƒ˜ãƒƒãƒ€ãƒ¼ã®ãƒ­ã‚´ãƒ»ã‚¿ã‚¤ãƒˆãƒ«ã‹ã‚‰ãƒˆãƒƒãƒ—ç”»é¢ã¸ã®æˆ»ã‚Šæ©Ÿèƒ½
3.  **APIã‚­ãƒ¼ç®¡ç†ã®å¼·åŒ–:**
    *   localStorageä¿å­˜ã®å¾©å…ƒã¨è‡ªå‹•é©ç”¨
    *   è¨­å®šç”»é¢ã§ã®ã€Œä¸‹4æ¡è¡¨ç¤ºã€ã«ã‚ˆã‚‹é©ç”¨ç¢ºèªæ©Ÿèƒ½
    *   å…±æœ‰ã‚­ãƒ¼ä½¿ç”¨æ™‚ã®è­¦å‘Šè¡¨ç¤º

### Phase 2: ãƒ¢ãƒã‚¤ãƒ«APIåˆ¶é™ã¸ã®å¯¾å¿œï¼ˆè©¦è¡Œã¨æœ€é©åŒ–ï¼‰
4.  **ã‚µãƒ¼ãƒãƒ¼å´ã®å …ç‰¢åŒ–:**
    *   ãƒ¢ãƒ‡ãƒ«ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ãƒã‚§ãƒ¼ãƒ³ã®å®Ÿè£…ï¼ˆnano-banana â†’ 2.0-flash â†’ 1.5-pro â†’ 1.5-flashï¼‰
    *   ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆæ™‚é–“ã‚’90ç§’ã«å»¶é•·ï¼ˆãƒ¢ãƒã‚¤ãƒ«é€šä¿¡ç’°å¢ƒã‚’è€ƒæ…®ï¼‰
    *   åˆ¶é™ã‚¨ãƒ©ãƒ¼æ™‚ã®è‡ªå‹•ãƒªãƒˆãƒ©ã‚¤æ©Ÿèƒ½ï¼ˆ1ç§’é–“éš”ï¼‰
5.  **ç”»åƒå‡¦ç†ã®æœ€é©åŒ–:**
    *   å‚è€ƒç”»åƒ: 1000pxï¼ˆå“è³ªã¨ãƒˆãƒ¼ã‚¯ãƒ³æ¶ˆè²»ã®ãƒãƒ©ãƒ³ã‚¹ï¼‰
    *   åœ§ç¸®å“è³ª: 0.8ï¼ˆJPEGï¼‰
    *   æ¸…æ›¸æ™‚ã®ãƒ‰ãƒ©ãƒ•ãƒˆç”»åƒå‚ç…§: æœ‰åŠ¹ï¼ˆãƒ‡ã‚¶ã‚¤ãƒ³ã®ä¸€è²«æ€§ã‚’ç¢ºä¿ï¼‰
6.  **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®æ”¹å–„:**
    *   è©³ç´°ãªã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®è¡¨ç¤ºï¼ˆGoogle APIã‹ã‚‰ã®ç”Ÿãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å«ã‚€ï¼‰
    *   Quota Exceededæ™‚ã®å…·ä½“çš„ãªå¯¾å‡¦æ³•ã®æç¤º

