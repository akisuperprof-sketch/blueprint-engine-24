# アプリケーション仕様書: ブループリントエンジン24 (Blueprint Engine 24)

## 概要
「ブループリントエンジン24」は、ビジネス文脈で求められる高度な「構造化」「図解化」「体系設計」を自動で行う生成的知的エンジンです。
思考を“構造化された設計図”として瞬時に可視化し、企画・戦略・教育資料などの作成時間を大幅に短縮します。

## ブランド定義
- **名称:** ブループリントエンジン24 (Blueprint Engine 24)
- **キャッチコピー:** 複雑を、美しく。あなたの頭脳のもう一つの設計エンジン。
- **コンセプト:** 思考の可視化と構造化。論理思考とAIの融合。
- **デザイン:** "Light Mode Blueprint" テーマ。ホワイトベースにブルーのグリッドを配し、先進性と清潔感を両立した設計エンジンUI。ロゴを統合済み。

## コア機能
1. **論理構造解析 (Step 1-2):**
   - ユーザー入力テキストから論理構造を抽出し、JSON形式で構成案を作成。
   - **詳細設定:** 構造タイプ（アーキタイプ）の指定や、追加の細かいデザイン指示が可能。
   - 「リテイク機能」により、ユーザーは自然言語で構成の修正指示が可能。

2. **リファレンス画像統合 (Step 1-2):**
   - **画像アップロード:** 最大4枚までの参考画像やキャラクター画像をアップロード可能。
   - **必須フラグ:** アップロードした画像（キャラクター等）の使用を「必須」に設定し、強力に生成結果に反映させる機能。
   - Step 2での画像プレビュー機能。

3. **ドラフト・プレビュー (Step 3):**
   - 最終デザインの前に、必ず「白黒ワイヤーフレーム（ラフ画）」を出力。
   - レイアウトや文字配置の事前確認・修正を可能にし、UXを向上させる。

4. **スタイル・レンダリング & 微調整 (Step 4):**
   - **スタイル選択:** 10種類の独自スタイル定義（ビジネス、テック、手書き等）を搭載。Recraft風のビジュアルグリッド選択。
   - **生成と微調整:** ドラフトの構図を維持したまま高解像度で清書。
   - **Refine機能:** 生成後の画像に対して、プロンプトベースで微調整（色味変更、要素修正など）が可能。

5. **履歴管理・自動保存:**
   - 生成完了時にセッション情報（入力、設定、画像）を自動保存。
   - ヘッダーの履歴アイコンから過去のセッションを呼び出し、再開・修正が可能。

## 技術スタック
- **Frontend:** Streamlit (Custom CSS injected, Default Header Hidden)
- **AI Core:** Google Gemini API (gemini-1.5-pro for Logic, gemini-2.0-flash-exp for Image)
- **Storage:** Local File System (`history_data` directory) for session persistence.
